---
title: 【面试题】http
date: 2021-03-29 18:48:50
categories: http
tags: [http, 面试]
---

### 常用 http 请求码

- **301** （永久移动） 请求的网页已永久移动到新位置。 服务器返回此响应（对 GET 或 HEAD 请求的响应）时，会自动将请求者转到新位置，url 会换成新的。
- **302** （临时移动） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求，url 不会变。
- **304** （未修改） 自从上次请求后，请求的网页未修改过。 服务器返回此响应时，不会返回网页内容。数据从缓存获取。
- **400** （错误请求） 服务器不理解请求的语法。
- **401** （未授权） 请求要求身份验证。 对于需要登录的网页，服务器可能返回此响应。
- **403** （禁止） 服务器拒绝请求。
- **404** （未找到） 服务器找不到请求的资源。
- **405** （方法禁用） 禁用请求中指定的方法。
- **500** （服务器内部错误） 服务器遇到错误，无法完成请求。
- **501** （尚未实施） 服务器不具备完成请求的功能。例如，服务器无法识别请求方法时可能会返回此代码。
- **502** （错误网关） 服务器作为网关或代理，从上游服务器收到无效响应。
- **503** （服务不可用） 服务器目前无法使用（由于超载或停机维护）。
- **504**（网关超时） 服务器作为网关或代理，但是没有及时从上游服务器收到请求。
- **505** （HTTP 版本不受支持） 服务器不支持请求中所用的 HTTP 协议版本。

### 强缓存与协商缓存

- **强缓存**（按照优先级排序）
  - **cache-control**（HTTP/1.1 中定义）
    ```nginx
    add_header    Cache-Control  max-age=3600;
    ```
    > 设置 Cache-Control 则会覆盖 `expires` 设置
  - **expires**（HTTP/1.0 中定义）
    expires 设置资源缓存的时间
    ```nginx
    # 设置一天后过期  s: 秒， m: 分， h: 时， d: 天
    expires 1d;
    ```
- **协商缓存**
  第一次请求数据时，服务器会返回缓存标识和数据资源，客户端会将缓存标识与数据保存在本地
  第二次请求数据时，会将缓存标识发送给服务器，服务器根据标识判断，如果可以使用缓存，则返回 304 状态码，浏览器使用缓存的数据内容
  - **Etag / If-None-Match**
    Etag：服务器响应请求时，告诉浏览器当前资源在服务器的唯一标识（生成规则由服务器决定）
    If-None-Match：再次请求服务器时，会将标识发送给服务器，服务器发现 `If-None-Match` 与被请求资源的标识一致时，则返回 304，并从本地缓存获取资源，否则重新获取新数据
  - **Last-Modified / If-Modified-Since**
    Last-Modified：服务器在响应请求时，告诉浏览器资源的最后修改时间。
    If-Modified-Since：下次请求时会带上此前的资源修改时间，

### Http 和 http2 的区别

- **二进制传输**
  http2 采用二进制传输，相对于 http 的文本传输安全性高
- **多路复用**
  http 一个连接只能提交一个请求，http2 可以执行多个请求，可以降低连接的数量，提高网络的吞吐量。
  同一个 TCP 连接，同一时刻可以传输多个 HTTP 请求。
- **头部压缩**
  HTTP2 gzip 与 compress 对头部进行压缩，客户端和服务端之间维护了一个头部索引表，通过 id 就可以进行头部的信息传输，缩小头部容量，提升传输效率。
- **HTTP2 支持服务器推送**
  http2 可以主动推送资源到客户端，避免客户端花过多时间逐个请求，降低响应时间。

### 永久性重定向（301）和临时性重定向（302）对 SEO 有什么影响

- 301 重定向可促进搜索引擎优化效果。
- 302 重定向可影响搜索引擎优化效果。

### 接口如何防刷

- 网关控制流量洪峰，对在一个时间段内出现流量异常，可以拒绝请求
- 源 ip 请求个数限制。对请求来源的 ip 请求个数做限制
- http 请求头信息校验；（例如 host，User-Agent，Referer）
- 人机验证，验证码，短信验证码，滑动图片形式
- 拦截器特定信息校验，例如：token

### 为什么 HTTP1.1 不能实现多路复用

HTTP/1.1 不是二进制传输，而是通过文本进行传输。由于没有流的概念，在使用并行传输（多路复用）传递数据时，接收端在接收到响应后，并不能区分多个响应分别对应的请求。
